## Port/Network Discovery

<u>**Nmap scans in order:**</u>

```bash
sudo masscan -p1-65535 $ip --rate=1000 -e tun0 > masscan.txt
cat masscan.txt

nmap -sV –Pn -p [ports of masscan separated by commas] -oN nmap/initial $ip
```

If no ports are found, scan in parts

```bash
nmap -Pn -n -vvv -p1-500 -oN nmap/partial $ip
```

TCP quick scan:

```bash
sudo nmap -sS -sC -F --open -Pn -sV $ip
```

TCP deep scan:

```bash
tcpports=$(cat masscan.txt | cut -d ' ' -f 4 | cut -d '/' -f 1 | sort -n | tr '\n' ',' | sed 's/,$//')
sudo nmap -sS --script "default,safe" -p $tcpports -oA tcp --open -Pn -sV $ip
```

UDP quick scan:

```bash
sudo nmap -sU -F --open -Pn -sV $ip
```

UDP deep scan:

```bash
sudo nmap -v -sU -F --open -Pn -sV --version-intensity 0 -T4 $ip
 OR
sudo nmap -vvv -sU -o nmapudp $ip --max-retries 0
```

**<u>Banner Grabbing</u>**

```bash
telnet $ip [port]
nc -nv $ip [port]
curl -iv $ip
```

